


AI 엔지니어는 **인공지능(AI) 시스템을 설계, 개발, 구축 및 유지 관리**하는 일을 담당한다.
현재 거대언어모델(LLM)이 더욱 강력해지고 많은 작업을 수행하면서, 더 많은 애플리케이션을 개발할 수 있게 되었다. 
뿐만 아니라, 대규모 언어모델을 학습하려면 데이터, 컴퓨팅 자원, 전문 인력이 필요하기 때문에 소수의 기업만이 이를 감당할 수 있다.따라서, 특정 조직에서 개발한 모델을 다른 사람들이 서비스로 이용하게되었다. 


오늘은 이 AI 엔지니어링이 뜨는 이유와 그 원동력인 파운데이션 모델에 대해 다뤄보려고 한다.


# 1.1 ) AI 엔지니어링의 부상

## 언어 모델 *language model*

- 언어 모델의 기본 단위는 토큰(*모델에 따라 문자, 단어, 단어의 일부가 될 수 있음)
- 토큰화 : 원문을 모델이 정한 길이로 나누는 과정
- 어휘 *vocabulary* : 모델이 다룰 수 있는 모든 토큰의 집합

- 언어 모델의 출력에는 제한이 없고, 정해진 유한한 어휘만을 사용해서 무한히 다양한 결과물을 만들어낼 수 있기 때문에 우리는 **생성형 모델** *generative model* 이라고 부른다.

- 언어 모델을 텍스트(프롬프트)가 주어지면 해당 텍스트를 완성하는 완성 기계이고, **완성된 결과는 확률에 기반한 예측이므로, 정확성이 보장되지 않는다.**


### 마스크 언어 모델 

- 누락된 토큰 전후 context(문맥)를 사용해 시퀀스의 어느 위치에서든 누락된 토큰을 예측하도록 학습한다.
- 따라서, 기본적으로 빈칸을 채울 수 있도록 학습된다.
![](https://velog.velcdn.com/images/algorithm_cell/post/0f9e252e-10a9-4836-a09e-5dcee900180a/image.png)


### 자기회귀 언어 모델

- 이전 토큰들만 보고 시퀀스의 다음 토큰을 예측하도록 학습한다.
- 따라서, 토큰을 하나씩 순차적으로 생성할 수 있고, 오늘날 텍스트 생성 분야의 대세다.
![](https://velog.velcdn.com/images/algorithm_cell/post/534237b7-b78f-4a3c-9c82-4384a2b7c895/image.png)


## 자기 지도 학습
- 언어 모델은 예전부터 존재했지만, **자기 지도 학습** *self-supervised learning* 덕분에 성장할 수 있었다. 
- 지도학습은 데이터 레이블링 작업으로 인해 많은 비용이 소모되는데, 자기 지도학습은 데이터 레이블링 병목 현상을 극복하는 데 도움이 된다.

### 과정
- 모델이 입력 데이터에서 레이블을 추론할 수 있다.
- `<BOS>` `<EOS>` 과 같은 마커를 통해 언어 모델이 여러 시퀀스를 구분해서 처리할 수 있도록 돕는다.
![](https://velog.velcdn.com/images/algorithm_cell/post/550e3927-78d0-4237-928f-a129a5fb0184/image.png)

## 파운데이션 모델

- 파운데이션 : AI 애플리케이션에서 갖는 중요성과 요구사항에 맞게 발전시킬 수 있음을 의미한다.

- 언어 모델은 글자에만 국한되어있지만, 사람은 언어 뿐만 아니라 다양한 감각을 통해서 세상을 인식한다. 따라서 실제에 유의미하게 작동하기 위해 글자 이상의 데이터를 처리하는 능력이 필요하다.

- 기존 연구들은 자연어처리(text), 컴퓨터비전(image)를 각각 독립적으로 처리했지만, 이런 다른 형태의 **둘 이상의 데이터 형태를 처리할 수 있는 모델을 멀티모달 모델**이라고 부른다. 
-생성형 멀티모달 모델은 LMM *large multimodal model*이라고 한다.
![](https://velog.velcdn.com/images/algorithm_cell/post/b0569181-d1f3-41c1-a696-2793ae8fc7f5/image.png)

- 특정 작업에 대한 성능을 올리고 싶다면 *fine-tuning*이 필요하다.
- 뿐만 아니라, 모델이 원하는 결과물을 잘 내놓을 수 있도록 하기 위해 **프롬프트 엔지니어링** 기법을 사용할 수 있다. 
- 추가적으로, LLM이 원하는 분야에 특화되도록 지식을 보완해줄 수도 있는데, 데이터베이스를 활용해 지시를 보완하는 것을 **RAG(검색 증강 생성)** *retrieval-augmented generation*이라고 한다.

### AI 엔지니어링 
파운데이션 모델을 기반으로 애플리케이션을 만드는 과정 

- 이 분야가 빠르게 성장한 이유
    1. 범용 AI 능력 : 파운데이션 모델을 많은 작업을 수행할 수 있다.
    2. AI 투자 증가 : 벤쳐 캐피터로가 기업에서의 AI에 대한 투자가 증가했다.
    3. AI 애플리케이션 개발에 대한 낮아진 진입 장벽 : API 호출을 통해 강력한 모델에 접근할 수 있으며, AI가 코드를 작성해주기 때문이다.

# 1.2) AI 파운데이션 모델 활용 사례
![](https://velog.velcdn.com/images/algorithm_cell/post/1316c8dd-7e4b-46f1-b9c3-aaa74f604960/image.png)
1. 코딩
2. 이미지 및 동영상 제작
3. 글쓰기
4. 교육 
- 예시) 듀오링고
 AI는 객관식과 주관식 퀴즈를 모두 생성하고 응답을 평가할 수 있다. 특히, 개인화 단계에서 가장 유용하다.
![](https://velog.velcdn.com/images/algorithm_cell/post/5e8715ab-3078-4da8-8838-4e3e4faf2cda/image.png)
5. 대화형 챗봇
6. 정보 집계
7. 데이터 체계화
8. 워크플로 자동화
---
![](https://velog.velcdn.com/images/algorithm_cell/post/0b74c8de-b587-42ff-a31a-fc041b07ac33/image.png)




# 1.3) AI 애플리케이션 기획

AI 애플리케이션을 기획하기 위한 단계에 대한 설명이다.
AI 엔지니어링은 ML(machine learning) 엔지니어링에서 발전했다는 것을 인식할 필요가 있다.

## 1. 활용 사례 평가


- 비즈니스 결정과 마찬가지로 AI 애플리케이션을 **왜** 만들고 싶은지 고민해야한다.
- **AI가 맡는 역할**을 구체화해야한다.
	
    1. **핵심적 또는 보완적** : 앱이 AI 없이도 작동한다(보완)
       
    - AI가 핵심적일수록, AI가 더 정확하고 신뢰할 수 있어야한다.
      
    2. **반응형 또는 선제형** : 사용자의 요청에 응답(반응형) , '적절한 시점'에 유용한 것을 제시(선제형)
       
    - 선제형 일수록 더 높은 품질 기준을 요구한다.
      
    3. **동적 또는 정적** : 사용자 피드백을 통해 지속적으로 업데이트(동적), 주기적으로만 업데이트(정적)
       
    - AI 관점에서는 사용자가 자신의 데이터로 모델을 계속 파인튜닝하며 자신만의 모델을 갖게 되는 것을 의미

- **사람이 맡는 역할**을 구체화해야한다.
- AI 애플리케이션을 독립형 제품으로 판매한다면 **방어 가능성**을 고려해야한다.
	
    - 낮은 진입 장벽은 *축복이자 저주이다.*
   
결국, AI 분야에서의 경쟁 우위는 **1.기술력 2.데이터 3.유통력**이다.

## 2. 기대치 설정

- 성공이 어떤 모습일지 파악해야한다.
- 따라서, 성공을 판단하기 위한 기준 **지표**를 설정해야 한다.

## 3. 마일스톤 계획

- 측정 가능한 목표를 설정했다면 이를 달성하기 위한 계획이 필요하다.

	- 모델의 최소 성능을 달성하는데 드는 자원에 대해 고려해야한다. 파운데이션 모델은 초기 성능은 좋을 수 있지만, 성능을 향상시키는 것은 어려울 수 있다.
   
## 4. 유지보수

- AI는 빠르게 변하고 있기 때문에, 목표를 달성 한 이후에도, 제품이 시간이 지나면서 어떻게 변하고 어떻게 유지보수할 지에 대해 생각해야한다.

## 5. 기타

- 기술 투자에 대한 비용-편익 분석을 해야한다.
- 현재 AI 관련 기술을 엄격하게 규제된다. 적용하기 어려운 변화들에 대해서도 생각해볼 필요가 있다.

# 1.4) AI 엔지니어링 스택 

AI 제품을 만들기 위해 필요한 엔지니어링 스택에 대해 알아보자.

## AI application stack

1. 애플리케이션 개발

- 모델에 적절한 프롬프트와 필요한 컨텍스틑 제공
- 좋은 애플리케이션에는 좋은 인터페이스가 필요

2. 모델 개발 
- 모델링, 학습, 파인튜닝, 추론 최적화를 위한 프레임워크를 포함해 모델을 개발하기 위한 도구
- 데이터가 모델 개발의 핵심이므로 이 계층은 데이터셋 엔지니어링도 포함

3. 인프라
- 모델 서빙, 데이터와 컴퓨팅 관리, 모니터링을 위한 도구

![](https://velog.velcdn.com/images/algorithm_cell/post/5562aea8-59c9-4888-924c-26138a8bd6e1/image.png)

## ML 엔지니어링과의 차이점

- AI 엔지니어링은 모델 개발보다는 모델 조정과 평가, 그리고 AI 인터페이스에 더 중점을 둔다.

### 모델 개발
**1. 모델링과 학습**
- 모델의 아키텍처를 고안, 학습하고, 파인튜닝하는과정을 의미한다.
- 따라서 전문적인 ML지식이 필요하다.

**2. 데이터셋 엔지니어링**
- AI 모델의 학습과 조정에 필요한 데이터를 선별하고, 새성하며, 주석을 다는 것
- ML 엔지니어링은 정형 데이터를 더 많이 다루는 반면, AI 엔지니어링은 비정형 데이터를 주로 다룬다.

**3. 추론 최적화**
- 모델을 더 빠르고 저렴하게 만드는 것을 의미한다.
- 파운데이션 모델이 더 높은 추론 비용과 지연 시간을 발생시키며, 추론 최적화는 더욱 중요한 과제로 떠올랐다.

![](https://velog.velcdn.com/images/algorithm_cell/post/4db08809-4ab9-42c9-aae9-179d1c14bff9/image.png)

### 모델 조정 기법
1. 프롬프트 엔지니어링 
- 프롬프트 기반 기법은 모델의 가중치를 업데이트하지 않고도 모델의 동작을 조정한다.
2. 파인튜닝
- 모델의 가중치를 업데이트해야한다.

### 평가
- 위험을 완화하고 기회를 발견하는 과정이다.
- 따라서, 모델을 조정하는 전체 주기에 걸쳐 평가가 이루어져야 한다.

- 폐쇄형 ML작업에서는 보통 모델 출력을 비교할 수 있는 예상 정답이 있는 반면, 챗봇처럼 개방형으로 응답을 생성하는 작업에는 하나의 정답이 없기 때문에 정답을 확인하는 것이 어렵다.

- 파운데이션 모델은 **조정 기술**이 많아서 평가가 어렵다.
![](https://velog.velcdn.com/images/algorithm_cell/post/bb574c2d-403d-478c-930d-a0cbf8413de5/image.png)

### AI 인터페이스
- 사용자가 AI 애플리케이션과 상호작용할 수 있는 인터페이스를 만드는 것이다.

## 풀스택 엔지니어링
- 인터페이스에 대한 강조가 커지면서 AI 엔지니어링은 풀스택 개발에 더 가까워지고 있다. 
